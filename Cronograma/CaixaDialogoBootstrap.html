<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <title>Hello, world!</title>
  </head>
  <body>
	<div class="container">
		<form id="myForm">
			<select class="form-select form-select-lg mb-3" 
					aria-label=".form-select-lg example" 
					id="datasSuspensasId" 
					onchange="obtenhaDataSelecionada()">
			</select>

			<select class="form-select form-select-lg mb-3" 
					aria-label=".form-select-lg example"
					id="turnosSuspensosId" 
					onchange="obtenhaTurnoSelecionado()">
			</select>
			<div class="col-12">
 				<!-- button type="submit" class="btn btn-primary" onclick="enviarDados()">Selecionei</button -->
				<input class="btn btn-primary" type="button" value="Selecionei" onclick="enviarDados()">
 			</div>
		</form>
	</div>
	<script>
		function atualizeDatas(dados) {
			atualizeSelect('datasSuspensasId', 'Escolha uma data', dados);
		}
		function atualizeTurnos(dados) {
			atualizeSelect('turnosSuspensosId', 'Escolha um turno', dados);
		}

		function atualizeSelect(elementoId, aviso, dados) {
			const dropdown = document.getElementById(elementoId);
			dropdown.innerHTML = ''; // Clear existing options
			dropdown.innerHTML = `<option selected>` + aviso + `</option>`
			dados.forEach(item => {
				const option = document.createElement('option');
				option.value = item;
				option.textContent = item;
				dropdown.appendChild(option);
			});
		}
		function obtenhaDataSelecionada() {
			return obtenhaValorSelecionado("datasSuspensasId");
		}
		function obtenhaTurnoSelecionado() {
			return obtenhaValorSelecionado("turnosSuspensosId");
		}
		function obtenhaValorSelecionado (id) {
			var valorEl = document.getElementById(id);
			var valor = valorEl.options[valorEl.selectedIndex].value;
			return valor;
		}
		function enviarDados() {
			let dataTurno = {
				'Data': '',
				'Turno': ''
			};

			dataTurno['Data'] = obtenhaDataSelecionada();
			dataTurno['Turno'] = obtenhaTurnoSelecionado();
			// google.script.run.withSuccessHandler(feixarCaixa).processarDataTurnoSelecionados(dataTurno);
			google.script.run.withSuccessHandler(feixarCaixa).cronogramaModelarProsseguir(dataTurno);
		}
		function feixarCaixa() {
			google.script.host.close();
		}			
	
		google.script.run.withSuccessHandler(atualizeDatas).getDatas();
		google.script.run.withSuccessHandler(atualizeTurnos).getTurnos();
	</script>
	<scrip src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

  </body>
</html>